!function(e){var o=e.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.unicodeModal=document.createElement("DIV"),e.Dom.addClass(this.unicodeModal,"unicode-modal"),this.unicodeModal.style.display="none",this.modalOpened=!1,this.instance.rootElement.appendChild(this.unicodeModal)},o.prototype.prepare=function(){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var o=this,t=this.cellProperties.characters||[],n=document.createElement("DIV");e.Dom.addClass(n,"unicode-modal-inner"),t.forEach(function(t){var d=document.createElement("DIV");e.Dom.addClass(d,"character-group");var r=document.createElement("DIV");e.Dom.addClass(r,"character-group-heading");var i=document.createElement("DIV");e.Dom.addClass(i,"character-group-body"),r.innerHTML="<h1>"+t.name||"</h1>";var a=t.characters||[];a.forEach(function(t){var n=document.createElement("span");e.Dom.addClass(n,"character"),n.addEventListener("click",function(e){var t=e.target.innerHTML;o.setValue(o.getValue()+t),o.refreshDimensions()}),n.innerHTML=t,i.appendChild(n)}),d.appendChild(r),d.appendChild(i),n.appendChild(d)}),e.Dom.empty(this.unicodeModal),this.unicodeModal.appendChild(n)},o.prototype.open=function(){e.editors.TextEditor.prototype.open.apply(this,arguments);var o=e.Dom.outerHeight(this.TD),t=e.Dom.offset(this.instance.rootElement),n=e.Dom.offset(this.TD);this.unicodeModal.style.position="absolute",this.unicodeModal.style.top=n.top-t.top+o+"px",this.unicodeModal.style.left=n.left-t.left+"px",this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown)},o.prototype.close=function(){this.hideModal(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),e.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.onBeforeKeyDown=function(e){var o=this,t=o.getActiveEditor();e.ctrlKey&&32===e.keyCode&&t.showModal(),27===e.keyCode&&t.modalOpened&&(t.hideModal(),e.stopImmediatePropagation(),e.preventDefault())},o.prototype.showModal=function(){this.modalOpened=!0,this.unicodeModal.style.display=""},o.prototype.hideModal=function(){this.modalOpened=!1,this.unicodeModal.style.display="none"};var t=function(e,o,t,n,d,r,i){return o.innerHTML=r,o};e.editors.UnicodeEditor=o,e.editors.registerEditor("unicode",o),e.renderers.UnicodeRenderer=t,e.renderers.registerRenderer("unicode",t),e.cellTypes.unicode={editor:e.editors.UnicodeEditor,renderer:e.renderers.UnicodeRenderer}}(Handsontable);